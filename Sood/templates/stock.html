{% extends 'layout.html' %}
{% load static %}
{% block body %}


<br>

<div class="w3-row">
    <h2 class="w3-panel w3-rightbar w3-margin"> نام نماد: {{ data.title }}</h2>

</div>
<div class="w3-row w3-padding-64 w3-margin">
    <div id="Stock2Chart" style="width:100%; height:800px;"></div>

    <br />
<h3 class="w3-panel w3-rightbar w3-margin">خطوط حمایت و مقاومت سهم</h3>
<p>در نمودار زیر خطوط <b style="color: red;">قرمز</b> نشان دهنده خطوط مقاومت و خطوط <b style="color: green;">قرمز</b> نشان دهنده ی خطوط حمایت در بازه ی <b>55</b> روزه می باشد.</p>
<br />    
<div id="Stock3Chart" style="width:100%; height:800px;"></div>
</div>



<script type="text/javascript">


    $(function () {
        $('#Stock2Chart').highcharts({


            chart: {
                type: 'spline'
            },
            xAxis: {
                type: 'datetime',
            },
            title: {
                text: 'قیمت سهام {{ data.title | safe }}'
            },
            rangeSelector: {
                enabled: true,
                selected: 1,
            },
            series: [{
                type: 'candlestick',
                name: '{{ data.title | safe }}',
                data: {{ data.data | safe }}.sort(function (a, b) {
                    return a.x - b.x;
                }),
            tooltip: {
            pointFormatter: function () {
                var point = this;
                var s = '';
                s += '<span style="color:green">\u25CF</span> ' + point.series.name + ': <b>' + (point.y) + '</b><br/>';
                s += '<span style="color:green"></span> open: <b>' + (point.open) + '</b><br/>';
                s += '<span style="color:green"></span> high: <b>' + (point.high) + '</b><br/>';
                s += '<span style="color:green"></span> low: <b>' + (point.low) + '</b><br/>';
                s += '<span style="color:green"></span> close: <b>' + (point.close) + '</b><br/>';
                return s;
            }
        }
            },
        {

            type: 'line',
            name: 'میانگین 5 روزه',
            data: {{ data.ma5 | safe }}.sort(function (a, b) {
                return a.x - b.x;
            }),

        tooltip: {
        pointFormatter: function () {
            var point = this;
            var s = '';
            s += '<span style="color:' + point.color + '">\u25CF</span> ' + point.series.name + ': <b>' + (point.y) + '</b><br/>';
            return s;
        }
    }

            }, {

            type: 'line',
            name: 'میانگین 10 روزه',
            data: {{ data.ma10 | safe }}.sort(function (a, b) {
                return a.x - b.x;
            }),

        tooltip: {
        pointFormatter: function () {
            var point = this;
            var s = '';
            s += '<span style="color:' + point.color + '">\u25CF</span> ' + point.series.name + ': <b>' + (point.y) + '</b><br/>';
            return s;
        }
    }

    },
        {

            type: 'line',
            name: 'میانگین 20 روزه',
            data: {{ data.ma20 | safe }}.sort(function (a, b) {
                return a.x - b.x;
            }),

        tooltip: {
        pointFormatter: function () {
            var point = this;
            var s = '';
            s += '<span style="color:' + point.color + '">\u25CF</span> ' + point.series.name + ': <b>' + (point.y) + '</b><br/>';
            return s;
        }
    }

    },
        {

            type: 'line',
            name: 'میانگین 50 روزه',
            data: {{ data.ma50 | safe }}.sort(function (a, b) {
                return a.x - b.x;
            }),

        tooltip: {
        pointFormatter: function () {
            var point = this;
            var s = '';
            s += '<span style="color:' + point.color + '">\u25CF</span> ' + point.series.name + ': <b>' + (point.y) + '</b><br/>';
            return s;
        }
    }
    },
        ]
        });
    });














    $(function () {
        $('#Stock3Chart').highcharts({
            chart: {
                type: 'spline'
            },
            xAxis: {
                type: 'datetime',
            },
            title: {
                text: 'حمایت و مقاومت سهام {{ data.title | safe }}'
            },
            rangeSelector: {
                enabled: true,
                selected: 1,
            },
            yAxis: {
                plotLines: {{data.level| safe}},
                
        },
            series: [{
                type: 'candlestick',
                name: '{{ data.title | safe }}',
                data: {{ data.data | safe }}.sort(function (a, b) {
                    return a.x - b.x;
                }),
            tooltip: {
            pointFormatter: function () {
                var point = this;
                var s = '';
                //s += '<span style="color:green">\u25CF</span><b>'+ point.series.name +'</b> : <b>' + (point.y) + '</b><br/>';
                s += '<span style="color:green">\u25CF</span><b> Prices </b><br/>';
                s += '<span style="color:green"></span> open: <b>' + (point.open) + '</b><br/>';
                s += '<span style="color:green"></span> high: <b>' + (point.high) + '</b><br/>';
                s += '<span style="color:green"></span> low: <b>' + (point.low) + '</b><br/>';
                s += '<span style="color:green"></span> close: <b>' + (point.close) + '</b><br/>';
                return s;
            }
        }
            },

        ]

        });
    });


</script>


{% endblock %}